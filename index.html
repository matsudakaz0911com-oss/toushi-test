<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成人のお祝い：投資知識確認テスト</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --bg-color: #f9f9f9;
        }

        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            line-height: 1.6;
            background-color: var(--bg-color);
            color: var(--primary-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .intro-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin-bottom: 30px;
            font-weight: bold;
            white-space: pre-wrap;
        }

        .quiz-item {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        .question-text {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .options label {
            display: block;
            margin-bottom: 10px;
            padding: 10px;
            background: #f1f1f1;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .options label:hover {
            background: #e2e2e2;
        }

        .options input {
            margin-right: 10px;
        }

        .btn-submit {
            display: block;
            width: 100%;
            padding: 15px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            cursor: pointer;
            margin-top: 20px;
        }

        .btn-submit:hover {
            opacity: 0.9;
        }

        #result {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .pass {
            color: var(--success-color);
            font-size: 2rem;
            font-weight: bold;
        }

        .fail {
            color: var(--accent-color);
            font-size: 2rem;
            font-weight: bold;
        }

        .review-section {
            text-align: left;
            margin-top: 30px;
            border-top: 2px solid #eee;
            padding-top: 20px;
        }

        .explanation {
            background: #f0f7ff;
            padding: 10px;
            margin-top: 10px;
            font-size: 0.9rem;
            border-radius: 5px;
        }

        @media print {
            .btn-submit { display: none; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>資産運用 基礎知識テスト</h1>

    <div id="intro">
        <div class="intro-box">【成人のお祝いのお金は、じいじとばあばが大変な思いをして貯めたお金なので、君の未来でより有効に活かせるようにして欲しいです。そのためには投資の長期運用が最も適切だと思いますが、リスクがないこともなく、これをきっかけに変なものに手を出しても困るので、最低限の知識を勉強してからにしてください。９５点の合格画面をスクショしてパパに送ってくれれば、ＮＩＳＡ口座を開設済みなのを条件に預かったお金を渡します。がんばってください！】</div>
        <button class="btn-submit" onclick="startQuiz()">テストを開始する</button>
    </div>

    <div id="quiz-area" style="display:none;">
        <form id="quiz-form">
            <div id="questions-container"></div>
            <button type="button" class="btn-submit" onclick="calcScore()">採点する</button>
        </form>
    </div>

    <div id="result">
        <div id="result-message"></div>
        <p id="score-display" style="font-size: 1.5rem; margin: 20px 0;"></p>
        <div id="instruction-after"></div>
        <button class="btn-submit" id="retry-btn" onclick="location.reload()" style="display:none;">もう一度挑戦する</button>
        
        <div class="review-section">
            <h3>正解と解説</h3>
            <div id="review-content"></div>
        </div>
    </div>
</div>

<script>
const quizData = [
    { q: "NISAの最大のメリットは？", a: ["元本保証がある", "運用益が非課税になる", "手数料が必ず無料になる"], c: 1, e: "通常は利益に約20％の税金がかかるが、新NISAではそれが非課税。少額投資非課税制度。個人が非課税で投資ができる制度。元本保証制度ではない。" },
    { q: "新NISAの非課税期間は？", a: ["20年", "5年", "無期限"], c: 2, e: "旧制度の５年間と違い期限がないため、若い時期から始める長期投資と非常に相性が良い。" },
    { q: "新NISAは「つみたて投資枠」と何で構成されている？", a: ["一般投資枠", "成長投資枠", "高配当枠"], c: 1, e: "金融庁が厳選した安全性の高いインデックスファンドしか買えない「つみたて投資枠」と、個別株なども買える「成長投資枠」がある。" },
    { q: "投資信託とは何か？", a: ["神様の信託に基づいて行う投資", "集めた資金をひとまとめにし、分散投資する金融商品", "人に言われた株に投資すること"], c: 1, e: "投資信託には指数連動型のインデックスファンドと、運用のプロが組み合わせを考えるアクティブファンドがある。" },
    { q: "インデックスファンドとは何を目指す投資信託？", a: ["市場平均を上回る成果", "市場平均と同じ値動き", "元本保証"], c: 1, e: "インデックスファンドは市場平均（指数）に連動することを目指す。勝とうとするのではなく、ついていく。" },
    { q: "アクティブファンドとの違いとして正しいものは？", a: ["インデックスは市場を上回ることを目指す", "アクティブは市場平均を目指す", "アクティブは市場を上回ることを目指す"], c: 2, e: "アクティブは「勝ちにいく運用」。その分コストが高くなる傾向がある。" },
    { q: "インデックスファンドの一般的な特徴は？", a: ["手数料が比較的低い", "短期で大きく儲かる", "値動きがほぼない"], c: 0, e: "アクティブ運用より運用コストが低いことが多い。長期ではコスト差が大きな差になる。" },
    { q: "分散投資の目的は？", a: ["必ず儲ける", "リスクを抑える", "流行に乗る"], c: 1, e: "1つに集中すると大きな損失を受ける可能性があるため、リスクを分散する。" },
    { q: "投資の三原則は？", a: ["長期・分散・積立", "集中・短期・高配当", "一括・集中・短期"], c: 0, e: "長期・分散・積立は再現性が高く、リスクが低く、感情に左右されにくい基本戦略。" },
    { q: "若いうちに始める最大のメリットは？", a: ["収入が多いから", "時間を味方にできるから", "若者優遇制度があるから"], c: 1, e: "複利は時間が長いほど効果を発揮する。若さは最大の武器。" },
    { q: "若い投資家の最大の武器は？", a: ["元本", "高利回り", "長い時間"], c: 2, e: "時間が長いほど複利効果と回復期間を確保できる。" },
    { q: "20歳から毎月1万円×40年と30歳から毎月2万円×30年で差が開きにくい理由は？", a: ["若者が優遇されるべきだから", "複利は元金だけでなく利息にも掛かるため、時間が長いほど強く働くから", "使える制度が違うから"], c: 1, e: "10年の時間差は非常に大きい。期間延長はリスクを増やさず複利効果を高められる。" },
    { q: "長期投資で最も重要なのは？", a: ["完璧なタイミング", "継続", "流行"], c: 1, e: "市場予測しタイミングを読むよりも、早く始めて続けることが成果を左右する。" },
    { q: "毎月一定額積立を何という？", a: ["一括投資法", "ドルコスト平均法", "高値追随法"], c: 1, e: "商品の価格に関係なく一定額を購入する。暴落時にも多く買えるため、狼狽しなくて済む。" },
    { q: "積立投資のメリットは？", a: ["常に安値で買える", "感情に左右されにくい", "必ず利益が出る"], c: 1, e: "自動積立は判断ミスを減らす。安値保証や利益保証ではない。" },
    { q: "価格が下がり続けるとき積立投資家にとっては？", a: ["失敗", "安く多く買える期間", "売却すべき"], c: 1, e: "長期前提なら、下落中は多くの口数を買える仕込み期。" },
    { q: "暴落時の基本行動は？", a: ["全売却", "積立停止", "継続"], c: 2, e: "感情で止めると安値購入機会を失う。長期前提なら継続が基本。" },
    { q: "下落相場で積立を止める最大の問題は？", a: ["手数料増", "安値購入機会を失う", "非課税枠減少"], c: 1, e: "下落局面こそ口数を増やせる時期。止めると将来の回復利益を失う。" },
    { q: "元本保証がないことは？", a: ["投資の前提", "異常", "違法"], c: 0, e: "投資は価格変動があることが前提。元本保証している高利回りの商品は詐欺。" },
    { q: "短期的な値下がりは？", a: ["普通に起こる", "失敗", "撤退サイン"], c: 0, e: "ここ数十年の間にもショックや戦争等があり、短期変動はよくある自然な現象。" },
    { q: "「みんなが買っているから買う」は？", a: ["正しい", "危険", "安全"], c: 1, e: "群集心理に流されると高値掴みの原因になる。" },
    { q: "投資で一番怖いのは？", a: ["暴落", "感情売買", "長期保有"], c: 1, e: "感情で売買すると安値売り・高値買いになりやすい。狼狽売りともいう。" },
    { q: "現金のまま保管していると○○○に負ける。", a: ["インフレ（物価上昇）", "デフレ（物価下落）", "税金上昇"], c: 0, e: "インフレにより現金の価値は相対的に下がる。投資は物価上昇への対策でもある。" },
    { q: "インデックスファンドが長期投資と相性が良い理由は？", a: ["常に値上がりするから", "広く分散されているから", "高配当だから"], c: 1, e: "1社ではなく市場全体に分散されているため、個別企業の倒産リスクを抑えられる。" },
    { q: "市場全体が成長すれば、インデックスファンドはどうなる？", a: ["必ず下がる", "一緒に成長しやすい", "変わらない"], c: 1, e: "指数に連動するため、経済成長の恩恵を受けやすい。" },
    { q: "インデックス投資の弱点は？", a: ["市場が下落すれば一緒に下がる", "分散できない", "手数料が非常に高い"], c: 0, e: "市場平均に連動するため、暴落時は避けられない。ただし長期前提で考える。" },
    { q: "インデックスファンドに投資する意味として最も近いものは？", a: ["1社に集中投資すること", "経済全体に投資すること", "短期売買で利益を狙うこと"], c: 1, e: "インデックス投資は「企業を選ぶ」のではなく「経済全体を買う」発想。" },
    { q: "最も再現性が高く人類の経済成長全体に分散して投資できる商品は？", a: ["オカルン", "オルカス", "オルカン"], c: 2, e: "オルカン（オール・カントリー）は全世界の株式に時価総額加重で投資する商品。" },
    { q: "購入する投資信託を選ぶ時に着目すべき点は？", a: ["手数料（信託報酬）", "有名な運用者か", "銀行の窓口で買えるか"], c: 0, e: "信託報酬のわずかな差が、20〜30年後には数十万〜百万円単位の差になる。" },
    { q: "未来をよくするための行動として、最も大切なことは？", a: ["完璧を目指すこと", "あきらめずに続けること", "ただ今を楽しむこと"], c: 1, e: "「小さなことを重ねることが、とんでもないところに行くただひとつの道」 （イチロー）" }
];

let shuffledQuiz = [];

function startQuiz() {
    document.getElementById('intro').style.display = 'none';
    document.getElementById('quiz-area').style.display = 'block';
    
    // シャッフル
    shuffledQuiz = [...quizData].sort(() => Math.random() - 0.5);
    
    const container = document.getElementById('questions-container');
    shuffledQuiz.forEach((data, index) => {
        const div = document.createElement('div');
        div.className = 'quiz-item';
        div.innerHTML = `
            <div class="question-text">Q${index + 1}. ${data.q}</div>
            <div class="options">
                ${data.a.map((ans, i) => `
                    <label>
                        <input type="radio" name="q${index}" value="${i}" required>
                        ${ans}
                    </label>
                `).join('')}
            </div>
        `;
        container.appendChild(div);
    });
}

function calcScore() {
    const form = document.getElementById('quiz-form');
    const formData = new FormData(form);
    let score = 0;
    
    // 全て回答しているかチェック
    let answeredCount = 0;
    for (let pair of formData.entries()) { answeredCount++; }
    if (answeredCount < 30) {
        alert("まだ未回答の問題があります。");
        return;
    }

    shuffledQuiz.forEach((data, index) => {
        const userAnswer = formData.get(`q${index}`);
        if (parseInt(userAnswer) === data.c) {
            score++;
        }
    });

    const percent = (score / 30) * 100;
    showResult(score, percent);
}

function showResult(score, percent) {
    document.getElementById('quiz-area').style.display = 'none';
    const resultDiv = document.getElementById('result');
    resultDiv.style.display = 'block';
    
    const scoreDisplay = document.getElementById('score-display');
    const messageDiv = document.getElementById('result-message');
    const instructionDiv = document.getElementById('instruction-after');
    const retryBtn = document.getElementById('retry-btn');
    
    scoreDisplay.innerText = `得点: ${score} / 30 点 (${Math.round(percent)}%)`;

    if (percent >= 95) {
        messageDiv.innerHTML = `<span class="pass">合格おめでとう！</span>`;
        instructionDiv.innerHTML = `
            <div style="background:#e8f5e9; padding:20px; border-radius:10px; margin-top:20px; border: 2px solid #2e7d32;">
                <p>素晴らしい結果です。最低限の知識は身につきました。</p>
                <p><strong>【この画面をスクリーンショットしてパパに送ってください】</strong></p>
                <p>NISA口座の開設が確認でき次第、お祝い金を渡します。長期運用で未来を豊かにしましょう！</p>
            </div>
        `;
        retryBtn.style.display = 'none';
    } else {
        messageDiv.innerHTML = `<span class="fail">不合格です</span>`;
        instructionDiv.innerHTML = `<p>合格には95点（29問以上の正解）が必要です。もう一度復習して挑戦してください。</p>`;
        retryBtn.style.display = 'block';
    }

    // 解説の表示
    const reviewContent = document.getElementById('review-content');
    reviewContent.innerHTML = '';
    shuffledQuiz.forEach((data, index) => {
        const div = document.createElement('div');
        div.style.marginBottom = '20px';
        div.innerHTML = `
            <strong>Q${index + 1}. ${data.q}</strong><br>
            正解: ${data.a[data.c]}
            <div class="explanation">解説: ${data.e}</div>
        `;
        reviewContent.appendChild(div);
    });

    window.scrollTo(0, 0);
}
</script>

</body>
</html>
